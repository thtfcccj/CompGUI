/***********************************************************************
             GB2312字库模块相关函数->取模方式1实现
此字库仅支持5*7点阵ASC码(0x20~0x7e)的显示:
***********************************************************************/

#include "GB2312ZM.h"

//取模：PC2LCD2002完美版(字符模式)：
//选项：阴码+逐列式+顺行+十六进制+自定义格式C51默认
//Terminal字体，ASC长宽比5*8(填入10,8),汉字点阵大小10*7(取消锁定并填入0,0,0,-1)：
static const unsigned char _Asc57ZM[][5] = {//直接在行内输入两次手动生成。
  {0x00,0x00,0x00,0x00,0x00},/*" ",0*/
  {0x00,0x00,0xFA,0x00,0x00},/*"!",1*/
  {0x00,0xC0,0x00,0xC0,0x00},/*""",2*/
  {0x28,0xFE,0x28,0xFE,0x28},/*"#",3*/
  {0x00,0x32,0x5E,0xF2,0x4C},/*"$",4*/
  {0x00,0x66,0x68,0x16,0x66},/*"%",5*/
  {0x00,0x1C,0xF2,0xB2,0x4C},/*"&",6*/
  {0x00,0x00,0x00,0xC0,0x00},/*"'",7*/
  {0x00,0x00,0x7C,0x82,0x00},/*"(",8*/
  {0x00,0x00,0x82,0x7C,0x00},/*")",9*/
  {0x00,0x38,0x7C,0x38,0x00},/*"*",10*/
  {0x00,0x10,0x7C,0x10,0x00},/*"+",11*/
  {0x00,0x00,0x00,0x06,0x00},/*",",12*/
  {0x00,0x10,0x10,0x10,0x10},/*"-",13*/
  {0x00,0x00,0x02,0x00,0x00},/*".",14*/
  {0x00,0x02,0x0C,0x30,0xC0},/*"/",15*/
  {0x00,0x7C,0x82,0x82,0x7C},/*"0",16*/
  {0x00,0x42,0xFE,0x02,0x00},/*"1",17*/
  {0x00,0x46,0x8A,0x92,0x62},/*"2",18*/
  {0x00,0x44,0x92,0x92,0x6C},/*"3",19*/
  {0x00,0x1C,0x64,0xFE,0x04},/*"4",20*/
  {0x00,0xF2,0x92,0x92,0x8C},/*"5",21*/
  {0x00,0x7C,0x92,0x92,0x4C},/*"6",22*/
  {0x00,0xC0,0x8E,0x90,0xE0},/*"7",23*/
  {0x00,0x6C,0x92,0x92,0x6C},/*"8",24*/
  {0x00,0x64,0x92,0x92,0x7C},/*"9",25*/
  {0x00,0x00,0x24,0x00,0x00},/*":",26*/
  {0x00,0x02,0x24,0x00,0x00},/*";",27*/
  {0x00,0x10,0x28,0x44,0x82},/*"<",28*/
  {0x00,0x28,0x28,0x28,0x28},/*"=",29*/
  {0x00,0x82,0x44,0x28,0x10},/*">",30*/
  {0x00,0x40,0x8A,0x90,0x60},/*"?",31*/
  {0x00,0x70,0x8E,0x92,0x7E},/*"@",32*/
  {0x00,0x7E,0x88,0x88,0x7E},/*"A",33*/
  {0x00,0xFE,0x92,0x92,0x6C},/*"B",34*/
  {0x00,0x7C,0x82,0x82,0x44},/*"C",35*/
  {0x00,0xFE,0x82,0x82,0x7C},/*"D",36*/
  {0x00,0xFE,0x92,0x92,0x82},/*"E",37*/
  {0x00,0xFE,0x90,0x90,0x80},/*"F",38*/
  {0x00,0x7C,0x82,0x92,0x5C},/*"G",39*/
  {0x00,0xFE,0x10,0x10,0xFE},/*"H",40*/
  {0x00,0x82,0xFE,0x82,0x00},/*"I",41*/
  {0x00,0x0C,0x02,0x02,0xFC},/*"J",42*/
  {0x00,0xFE,0x10,0x28,0xC6},/*"K",43*/
  {0x00,0xFE,0x02,0x02,0x02},/*"L",44*/
  {0x00,0xFE,0x60,0x60,0xFE},/*"M",45*/
  {0x00,0xFE,0x60,0x18,0xFE},/*"N",46*/
  {0x00,0xFE,0x82,0x82,0xFE},/*"O",47*/
  {0x00,0xFE,0x90,0x90,0x60},/*"P",0*/
  {0x00,0x7C,0x8A,0x86,0x7E},/*"Q",1*/
  {0x00,0xFE,0x98,0x94,0x62},/*"R",2*/
  {0x00,0x64,0x92,0x92,0x4C},/*"S",3*/
  {0x00,0x80,0xFE,0x80,0x80},/*"T",4*/
  {0x00,0xFC,0x02,0x02,0xFC},/*"U",5*/
  {0x00,0xF0,0x0E,0x0E,0xF0},/*"V",6*/
  {0x00,0xFE,0x0C,0x0C,0xFE},/*"W",7*/
  {0x00,0xC6,0x38,0x38,0xC6},/*"X",8*/
  {0xC0,0x20,0x1E,0x20,0xC0},/*"Y",9*/
  {0x00,0x86,0x9A,0xB2,0xC2},/*"Z",10*/
  {0x00,0x00,0xFE,0x82,0x00},/*"[",11*/
  {0xC0,0x30,0x0C,0x02,0x00},/*"\",12*/
  {0x00,0x00,0x82,0xFE,0x00},/*"]",13*/
  {0x00,0x40,0x80,0x40,0x00},/*"^",14*/
  {0x00,0x02,0x02,0x02,0x02},/*"_",15*/
  {0x00,0x00,0xC0,0x00,0x00},/*"`",16*/
  {0x00,0x04,0x1A,0x1A,0x1E},/*"a",17*/
  {0x00,0xFE,0x12,0x12,0x0C},/*"b",18*/
  {0x00,0x0C,0x12,0x12,0x12},/*"c",19*/
  {0x00,0x0C,0x12,0x12,0xFE},/*"d",20*/
  {0x00,0x0C,0x1A,0x1A,0x08},/*"e",21*/
  {0x00,0x10,0x3E,0x50,0x10},/*"f",22*/
  {0x00,0x08,0x14,0x14,0x1E},/*"g",23*/
  {0x00,0xFE,0x10,0x1E,0x00},/*"h",24*/
  {0x00,0x00,0x2E,0x00,0x00},/*"i",25*/
  {0x00,0x00,0x00,0x2E,0x00},/*"j",26*/
  {0x00,0xFE,0x08,0x14,0x12},/*"k",27*/
  {0x00,0x02,0xFE,0x02,0x00},/*"l",28*/
  {0x00,0x1E,0x10,0x1E,0x1E},/*"m",29*/
  {0x00,0x1E,0x10,0x10,0x0E},/*"n",30*/
  {0x00,0x0C,0x12,0x12,0x0C},/*"o",31*/
  {0x00,0x1E,0x12,0x12,0x0C},/*"p",32*/
  {0x00,0x0C,0x12,0x12,0x1E},/*"q",33*/
  {0x00,0x1E,0x08,0x10,0x10},/*"r",34*/
  {0x00,0x0A,0x1A,0x16,0x14},/*"s",35*/
  {0x00,0x10,0x3E,0x12,0x00},/*"t",36*/
  {0x00,0x1C,0x02,0x02,0x1E},/*"u",37*/
  {0x00,0x18,0x06,0x06,0x18},/*"v",38*/
  {0x18,0x06,0x1C,0x06,0x18},/*"w",39*/
  {0x00,0x12,0x0C,0x0C,0x12},/*"x",40*/
  {0x00,0x18,0x04,0x04,0x1E},/*"y",41*/
  {0x00,0x12,0x16,0x1A,0x12},/*"z",42*/
  {0x00,0x10,0xEE,0x82,0x00},/*"{",43*/
  {0x00,0x00,0xFE,0x00,0x00},/*"|",44*/
  {0x00,0x82,0xEE,0x10,0x00},/*"}",45*/
  {0x00,0x40,0x80,0x40,0x80},/*"~",46*/
};

//使用缓冲
static unsigned char _Asc8Buf[7];
#include <string.h>

//--------------------------------获得英文5*7字模--------------------------
const unsigned char *GB2312ZM_pGetAsc57(char Asc)
{
  if((Asc < 32) || (Asc >= 127)) Asc = ' ' - 32;  //异常检查并纠错
  else Asc -= 32;
  
  const unsigned char *pZM = &_Asc57ZM[Asc][0];
  
  //行列转换,如：  {0x00,0x00,0xFE,0x00,0x00},/*"|",44*/
  for(unsigned char x = 0; x < 7; x++){
    unsigned char yShift = 1 << (7 - x);    
    unsigned char ZM = 0;
    unsigned char xShift = 0x80;
    for(unsigned char y = 0; y < 5; y++){
      if(*(pZM + y) & yShift) ZM |= xShift;
      xShift >>= 1;
    }
    _Asc8Buf[x] = ZM;
  }
  return _Asc8Buf;
}

